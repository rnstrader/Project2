---
title: "Project2"
format: html
editor: visual
---


## Preparation for App
reading in Seoul Bike sharing data for the year-long period from December 2017 through November 2018. Locale argument was included to allow data to read in properly, as the formatting for date seemed to be giving it trouble.
```{r}
library(tidyverse)
bike <- read_csv("SeoulBikeData.csv", locale=locale(encoding="latin1"))
```

One-way and Two-way contingency tables.
```{r}
# number of holidays vs standard days across the year
holiday <- bike |> group_by(Holiday) |> summarize(count = n())
holiday

# days in which the system was functioning or not functioning by season
functioning <- bike |> group_by(`Functioning Day`, Seasons) |> summarize(count = n())
functioning
```

Numerical summaries for bike usage by season.
```{r}
summary <- bike |> group_by(Seasons) |> summarise(across(`Rented Bike Count`, .fns = list("mean" = mean, "median" = median, "var" = var, "sd" = sd), .names = "{.fn}_{.col}"))
summary
```

Six plots for investigating the data. two scatterplots, 4 multivariate
```{r}
#scatter plot for bike count vs rainfall faceted by season
bike |> ggplot(aes(x = `Rainfall(mm)`, y = `Rented Bike Count`)) + geom_point(size = 0.5, alpha = 0.6) + facet_wrap(vars(Seasons)) + theme_minimal() + labs(title = "Bike Count vs Rainfall by Season")

#scatter plot for bike count vs temperature colored by holiday
bike |> ggplot(aes(x = `Temperature(Â°C)`, y = `Rented Bike Count`, colour = Holiday)) + geom_point(size = 0.3) + theme_minimal() + labs(title = "Bike count vs Temperature by Holiday")

#heat map 2d plot for bike count vs snowfall colored by season
bike |> ggplot(aes(x = `Snowfall (cm)`, y = `Rented Bike Count`, colour = Seasons)) + geom_bin2d() + theme_minimal() + labs(title = "Bike Count vs Snowfall by Season")
```
